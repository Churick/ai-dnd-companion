# AI D&D Companion - Поэтапный план разработки

## **Концепция**
Кроссплатформенное веб-приложение для игры в Dungeons & Dragons с AI в роли Мастера. Локальные/бесплатные AI модели для генерации текста и изображений.

## **Стек технологий**
* **Фронтенд:** React + Vite + Tailwind CSS (быстрая разработка UI)
* **Бэкенд:** Python FastAPI (простота, асинхронность, хорошая работа с AI)
* **База данных:** SQLite (разработка) → PostgreSQL (продакшен)
* **LLM (текст):** Ollama (локально) или Google Gemini API (бесплатный tier)
* **Генерация изображений:** Replicate API (бесплатные минуты) или локальный Stable Diffusion
* **Аутентификация:** JWT-токены
* **Развертывание:** Docker, Vercel (фронтенд), Railway (бэкенд)

## **Этапы разработки**

### **Этап 0: Подготовка и проектирование (ТЕКУЩИЙ ЭТАП)**
- [x] Создать репозиторий на GitHub
- [x] Написать README.md
- [x] Создать .gitignore
- [ ] Составить схему базы данных (database_schema.md)
- [ ] Создать файл проекта (project_plan.md) ✅ *этот файл*

### **Этап 1: Бэкенд - ядро и LLM-интеграция**
**Цель:** Работающий сервер с базовой аутентификацией и интеграцией языковой модели.
1. Настройка Python окружения (FastAPI, виртуальное окружение)
2. Создание моделей SQLAlchemy по схеме БД
3. Реализация эндпоинтов аутентификации (регистрация/логин)
4. Интеграция с Ollama (локальная LLM) или Gemini API
5. Создание сервиса для генерации текста от AI Dungeon Master
6. Системный промпт для роли Мастера

### **Этап 2: Фронтенд - базовый интерфейс чата**
**Цель:** Веб-интерфейс для взаимодействия с AI.
1. Инициализация React-приложения с Vite
2. Создание компонентов: Login, Register, ChatInterface
3. Настройка маршрутизации (React Router)
4. Подключение к бэкенд API (axios)
5. Реализация отправки/получения сообщений
6. Базовая стилизация с Tailwind CSS

### **Этап 3: Интеграция генерации изображений**
**Цель:** Визуализация ключевых сцен игры.
1. Выбор бесплатного image-generation сервиса (Replicate/Stability AI)
2. Создание image-service в бэкенде
3. Логика триггеров генерации (когда AI решает, что нужна картинка)
4. Модификация LLM-сервиса для пометки сообщений флагами [GENERATE_IMAGE]
5. Отображение сгенерированных изображений во фронтенде
6. Кэширование изображений для экономии кредитов

### **Этап 4: Углубление игровой логики**
**Цель:** Полноценная игровая система с состоянием.
1. Расширение БД: JSON-поля для character_sheet и world_state
2. Эндпоинты для управления листом персонажа
3. Улучшение системного промпта с учетом состояния игры
4. Фронтенд: UI для просмотра/редактирования персонажа
5. Система бросков кубов через AI
6. Авто-обновление world_state на основе диалога

### **Этап 5: Монетизация и подготовка к продакшену**
**Цель:** Готовая к развертыванию система с возможностью монетизации.
1. Расширение модели пользователя: credits, subscription_plan
2. Панель профиля во фронтенде
3. Интеграция Stripe/PayPal для подписок (или простая система донатов)
4. Docker-контейнеризация приложения
5. Настройка CI/CD (GitHub Actions)
6. Развертывание на бесплатных облачных платформах
7. Добавление rate-limiting и оптимизация запросов к AI

## **Приоритеты использования бесплатных ресурсов**
1. **Текст:** Ollama с моделью Llama 3 (8B) - полностью бесплатно, локально
2. **Изображения:** Replicate API (бесплатные 500 минут в месяц) или локальный Stable Diffusion
3. **Хостинг:** Railway (бэкенд, $5/мес бесплатно первый месяц), Vercel (фронтенд, бесплатно)
4. **База данных:** Railway PostgreSQL (бесплатный tier)

## **Критические риски и решения**
- **Риск:** Локальные модели требуют мощного компьютера
  - **Решение:** Начать с облачных бесплатных API (Gemini), перейти на локальные позже
- **Риск:** Бесплатные квоты API могут закончиться
  - **Решение:** Система кэширования, fallback на текстовый режим
- **Риск:** Сложность настройки для новичков
  - **Решение:** Детальная документация, Docker-образы для быстрого старта

## **Метрики успеха**
1. Пользователь может начать новую игру и общаться с AI Мастером
2. Ключевые сцены автоматически визуализируются
3. Состояние персонажа сохраняется между сессиями
4. Приложение работает на бесплатных ресурсах минимум 1 месяц
5. Готовность к подключению платежной системы

---
*План может корректироваться в процессе разработки. Последнее обновление: 2024*